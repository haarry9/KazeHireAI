---
description: 
globs: 
alwaysApply: true
---
# ğŸ§­ Interviewer User Journey â€” KazeHire AI

## ğŸ­ User Role: Interviewer

**Permissions**:

- Can only access interviews where `interviewer_id` matches their logged-in user ID (from Supabase Auth).
- View candidate details and job ID for assigned interviews.
- Submit feedback (raw + AI-generated summary).
- No access to other interviewersâ€™ data or HR-specific functionality.

## ğŸªœ Step-by-Step Journey

### 1. Sign Up or Sign In (Supabase Auth)

- **Sign Up**:
    - Interviewer lands on the landing page and clicks â€œJoin.â€
    - Form collects: Name (display name, required), Email (required), Password (required), Role (HR or Interviewer, dropdown).
    - Supabase Auth handles sign-up via `supabase.auth.signUp`, storing name and role in user metadata or `users` table.
    - On success: Redirect to Interviewer Dashboard (`/interviews/assigned`).
    - On failure: Show toast (â€œInvalid email or passwordâ€ or â€œEmail already registeredâ€).
- **Sign In**:
    - Enters email and password; Supabase Auth handles via `supabase.auth.signInWithPassword`.
    - Frontend retrieves user role from `user.user_metadata.role` or `users` table, confirms â€œInterviewer,â€ and redirects to Interviewer Dashboard.
    - On failure: Show toast (â€œInvalid email or passwordâ€).

### 2. Interviewer Dashboard

- **Overview**: Central hub for managing assigned interviews.
- **Sections**:
    - **Upcoming Interviews**: Sorted by date.
    - **Processed Interviews**: Completed interviews (top 5).
- **Status Tags**: `Active`, `Completed`.
- **Table Columns**:
    - Candidate Name.
    - Job Title.
    - Interview Date.
    - â€œOpenâ€ button.
- **API Call**: `GET /api/interviews/`
    - Returns only interviews where `interviewer_id` matches the logged-in userâ€™s ID (from Supabase Auth JWT).
- **Outcome**: Show error toast on failure (â€œFailed to load interviewsâ€).
### 3. View Interview Details

- **From**: Clicking â€œOpenâ€ on the dashboard.
- **Details Page**:
    - **Candidate Information**:
        - Name, Email (readonly).
        - Resume viewer (PDF from Supabase Storage, `candidates.resume_url`).
    - **Job Details**: Description (rich-text viewer).
    - **Interview Details**: Date/Time, Status (Scheduled, Completed).
- **API Call**: `GET /api/interviews/[id]`
- **Access Control**: Redirect to `/interviews/assigned` if accessing unauthorized interviews (enforced by API route via `interviewer_id`).
- **Outcome**: Show error toast on failure (â€œFailed to load interview detailsâ€).

### 4. Submit Feedback

- **From**: Interview Details page (for Scheduled interviews).
- **Form**:
    - Raw Feedback (textarea, required).
    - Status (dropdown: Scheduled, Completed; default: Completed).
- **Generate AI Summary**:
    - Click â€œGenerate Summaryâ€ to send raw feedback + Job Description + resume to Gemini via `POST /api/interviews/[id]/feedback`.
    - Returns: `fit_score` (1â€“5), `summary` (text).
    - Display for approval (preview, no editing).
- **Outcome**: Show success toast (â€œSummary generatedâ€) or error toast (â€œFailed to generate summaryâ€).

### 5. Submit & Lock Feedback

- **From**: Click â€œSubmitâ€ after approving AI Summary.
- **Outcome**:
    - Raw feedback, AI Summary (`fit_score`, `summary`), and status saved in Supabase via `POST /api/interviews/[id]/feedback`.
    - Editing disabled post-submission.
    - Post-submission, Interviewer sees only AI Summary (Fit Score, Summary); raw feedback visible to HR only.
    - Show success toast (â€œFeedback submittedâ€) or error toast (â€œFailed to submit feedbackâ€).

### 6. Toast Notifications & UX Feedback

- **Show Toasts For**:
    - Success: AI summary generation (â€œSummary generatedâ€), feedback submission (â€œFeedback submittedâ€).
    - Error: Supabase Auth failures (â€œInvalid email or passwordâ€), form validation (â€œFeedback requiredâ€), API errors (`{"success": false, "error": "Reason"}`), data loading failures (â€œFailed to load interviewsâ€).

## ğŸ§± Backend Events Triggered in Interviewer Flow

|Action|Backend Responsibilities|
|---|---|
|Sign Up/Sign In|Supabase Auth handles user creation/login|
|View Interview|Fetch interview + candidate + job description via `/api/interviews/[id]`|
|Submit Feedback|Store raw feedback via `/api/interviews/[id]/feedback`|
|Generate AI Summary|Prompt Gemini with raw feedback + context via `/api/interviews/[id]/feedback`|
|Submit Final|Save AI result, update status via `/api/interviews/[id]/feedback`|

## ğŸ›‘ MVP Boundaries / No-Features

- No interview rescheduling/canceling by Interviewer.
- No viewing feedback of other interviews.
- No editing feedback after submission.
- No in-app chat or communication with HR.
- No email notifications or reminders.
- No performance analytics or history.
- No Interview Type field.
- No bias detection for Interviewer (HR-only feature).

---
